name: Custom macOS Client Generator
run-name: Custom macOS Client Generator

on: 
  workflow_dispatch:
    inputs:
      server:
        required: false
        default: ''
        type: string
      key:
        required: false
        default: ''
        type: string
      apiServer:
        required: false
        default: ''
        type: string
      custom:
        required: false
        default: ''
        type: string
      uuid:
        required: false
        default: ''
        type: string
      iconlink:
        required: false
        default: 'false'
        type: string
      logolink:
        required: false
        default: 'false'
        type: string
      appname:
        required: false
        default: 'rustdesk'
        type: string
      filename:
        required: false
        default: 'rustdesk'
        type: string
      extras:
        required: false
        default: '{}'
        type: string
  
  # Au cas où votre API utiliserait cet event (fréquent pour les triggers externes)
  repository_dispatch:
    types: [build-client]

env:
  SCITER_RUST_VERSION: "1.75"
  RUST_VERSION: "1.75"
  MAC_RUST_VERSION: "1.81"
  FLUTTER_VERSION: "3.24.5"
  VCPKG_COMMIT_ID: "120deac3062162151622ca4860575a33844ba10b"
  VERSION: "1.3.1"
  UPLOAD_ARTIFACT: 'true'
  VCPKG_BINARY_SOURCES: "clear;x-gha,readwrite"
  MACOS_P12_BASE64: "${{ secrets.MACOS_P12_BASE64 }}"
  STATUS_URL: ${{ github.event.inputs.apiServer }}/api/updategh
  # On force une version basse pour la compatibilité, mais on laisse le runner décider
  MACOSX_DEPLOYMENT_TARGET: "10.15"

jobs:
  # ... (Le reste du fichier reste identique à ma proposition précédente avec les jobs build-for-macos)
